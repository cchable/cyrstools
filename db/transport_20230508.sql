CREATE DATABASE 'localhost:transport'
USER 'SYSDBA' PASSWORD '**********'
PAGE_SIZE 8192
DEFAULT CHARACTER SET NONE;

/* Tables */
CREATE TABLE T_ANNEESSCOLAIRES (
  IDX_ANNEESCOLAIRE   INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  ANNEEANNEESCOLAIRE  INTEGER NOT NULL
) ;

CREATE TABLE T_CHAUFFEURS (
  IDX_CHAUFFEUR       INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  PRENOMCHAUFFEUR     VARCHAR(20) NOT NULL,
  PRINCIPALCHAUFFEUR  BOOLEAN DEFAULT TRUE,
  ACTIFCHAUFFEUR      BOOLEAN DEFAULT TRUE
) ;

CREATE TABLE T_EPHEMERIDES (
  IDX_EPHEMERIDE      INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  IDX_ANNEESCOLAIRE   INTEGER NOT NULL,
  NOMEPHEMERIDE       VARCHAR(60) NOT NULL,
  STARTDATEPHEMERIDE  DATE NOT NULL,
  ENDDATEPHEMERIDE    DATE NOT NULL
) ;

CREATE TABLE T_ETAPES (
  IDX_ETAPE       INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  NOMETAPE        VARCHAR(60) CHARACTER SET UTF8 NOT NULL,
  ADRESSEETAPE    VARCHAR(100) CHARACTER SET UTF8 NOT NULL,
  PRINTEDETAPE    BOOLEAN DEFAULT FALSE,
  LATITUDEETAPE   DOUBLE PRECISION,
  LONGITUDEETAPE  DOUBLE PRECISION,
  ALTITUDEETAPE   DOUBLE PRECISION
) ;

CREATE TABLE T_GROUPES (
  IDX_GROUPE                  INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  NOMGROUPE                   VARCHAR(20) CHARACTER SET UTF8 NOT NULL COLLATE UNICODE_CI,
  NOMBREACCOMPAGNATEURGROUPE  INTEGER,
  NOMBREGROUPE                INTEGER NOT NULL
) ;

CREATE TABLE T_INDISPONIBILITES (
  IDX_T_INDISPONIBILITE               INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  JOURENTIERINDISPONIBILITECHAUFFEUR  BOOLEAN DEFAULT FALSE
) ;

CREATE TABLE T_INDISPONIBILITESCHAUFFEURS (
  IDX_INDISPONIBILITECHAUFFEUR  INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  IDX_CHAUFFEUR                 INTEGER NOT NULL,
  STARTDATEINDISPONIBILITE      DATE NOT NULL,
  STARTTIMEINDISPONIBILITE      TIME,
  ENDDATEINDISPONIBILITE        DATE NOT NULL,
  ENDTIMEINDISPONIBILITE        TIME,
  ALLDAYINDISPONIBILITE         BOOLEAN
) ;

CREATE TABLE T_INDISPONIBILITESVEHICULES (
  IDX_INDISPONIBILITEVEHICULE  INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  IDX_VEHICULE                 INTEGER NOT NULL,
  STARTDATEINDISPONIBILITE     DATE NOT NULL,
  STARTTIMEINDISPONIBILITE     TIME,
  ENDDATEINDISPONIBILITE       DATE NOT NULL,
  ENDTIMEINDISPONIBILITE       TIME,
  ALLDAYINDISPONIBILITE        BOOLEAN
) ;

CREATE TABLE T_MARQUES (
  IDX_MARQUE  INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  NOMMARQUE   VARCHAR(30) NOT NULL
) ;

CREATE TABLE T_ORGANISATIONS (
  IDX_ORGANISATION  INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  IDX_GROUPE        INTEGER NOT NULL,
  DATEORGANISATION  DATE NOT NULL,
  TIMEORGANISATION  TIME NOT NULL
) ;

CREATE TABLE T_TRAJETS (
  IDX_TRAJET        INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  IDX_ETAPEDEPART   INTEGER NOT NULL,
  IDX_ETAPEARRIVEE  INTEGER NOT NULL,
  NOMTRAJET         VARCHAR(60) CHARACTER SET UTF8 NOT NULL COLLATE UNICODE_CI,
  TEMPSTRAJET       TIME NOT NULL,
  KMTRAJET          FLOAT NOT NULL
) ;

CREATE TABLE T_TYPESVEHICULES (
  IDX_TYPEVEHICULE  INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  NOMTYPEVEHICULE   VARCHAR(20) NOT NULL
) ;

CREATE TABLE T_VEHICULES (
  IDX_VEHICULE      INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  IDX_MARQUE        INTEGER NOT NULL,
  IDX_TYPEVEHICULE  INTEGER NOT NULL,
  NOMVEHICULE       VARCHAR(30) NOT NULL,
  PLACESVEHICULE    INTEGER NOT NULL,
  NUMEROVEHICULE    SMALLINT NOT NULL,
  PLAQUEVEHICULE    VARCHAR(9) NOT NULL,
  MODELEVEHICULE    VARCHAR(30)
) ;
COMMIT;

/* Constraints */
ALTER TABLE T_ANNEESSCOLAIRES
  ADD PRIMARY KEY (IDX_ANNEESCOLAIRE);

ALTER TABLE T_CHAUFFEURS
  ADD PRIMARY KEY (IDX_CHAUFFEUR);

ALTER TABLE T_EPHEMERIDES
  ADD PRIMARY KEY (IDX_EPHEMERIDE);

ALTER TABLE T_ETAPES
  ADD PRIMARY KEY (IDX_ETAPE);

ALTER TABLE T_GROUPES
  ADD PRIMARY KEY (IDX_GROUPE);

ALTER TABLE T_INDISPONIBILITES
  ADD PRIMARY KEY (IDX_T_INDISPONIBILITE);

ALTER TABLE T_INDISPONIBILITESCHAUFFEURS
  ADD PRIMARY KEY (IDX_INDISPONIBILITECHAUFFEUR);

ALTER TABLE T_INDISPONIBILITESVEHICULES
  ADD PRIMARY KEY (IDX_INDISPONIBILITEVEHICULE);

ALTER TABLE T_MARQUES
  ADD PRIMARY KEY (IDX_MARQUE);

ALTER TABLE T_ORGANISATIONS
  ADD PRIMARY KEY (IDX_ORGANISATION);

ALTER TABLE T_TRAJETS
  ADD PRIMARY KEY (IDX_TRAJET);

ALTER TABLE T_TYPESVEHICULES
  ADD PRIMARY KEY (IDX_TYPEVEHICULE);

ALTER TABLE T_VEHICULES
  ADD PRIMARY KEY (IDX_VEHICULE);

COMMIT;
/* Foreign Keys */
ALTER TABLE T_EPHEMERIDES
  ADD CONSTRAINT T_EPHEMERIDES_FOREIGN_KEY01
  FOREIGN KEY (IDX_ANNEESCOLAIRE)
    REFERENCES T_ANNEESSCOLAIRES(IDX_ANNEESCOLAIRE)
    ON DELETE CASCADE
    ON UPDATE CASCADE;

ALTER TABLE T_INDISPONIBILITESCHAUFFEURS
  ADD CONSTRAINT T_INDISPONIBILITESCHAUFFEURS_FOREIGN_KEY01
  FOREIGN KEY (IDX_CHAUFFEUR)
    REFERENCES T_CHAUFFEURS(IDX_CHAUFFEUR)
    ON DELETE CASCADE
    ON UPDATE CASCADE;

ALTER TABLE T_INDISPONIBILITESVEHICULES
  ADD CONSTRAINT T_INDISPONIBILITESVEHICULES_FOREIGN_KEY01
  FOREIGN KEY (IDX_VEHICULE)
    REFERENCES T_VEHICULES(IDX_VEHICULE)
    ON DELETE CASCADE
    ON UPDATE CASCADE;

ALTER TABLE T_ORGANISATIONS
  ADD CONSTRAINT T_ORGANISATIONS_FOREIGN_KEY01
  FOREIGN KEY (IDX_GROUPE)
    REFERENCES T_GROUPES(IDX_GROUPE)
    ON DELETE CASCADE
    ON UPDATE CASCADE
    USING INDEX IDX_GROUPE;

ALTER TABLE T_TRAJETS
  ADD CONSTRAINT T_TRAJETS_FOREIGN_KEY01
  FOREIGN KEY (IDX_ETAPEDEPART)
    REFERENCES T_ETAPES(IDX_ETAPE)
    ON DELETE CASCADE
    ON UPDATE CASCADE;

ALTER TABLE T_TRAJETS
  ADD CONSTRAINT T_TRAJETS_FOREIGN_KEY02
  FOREIGN KEY (IDX_ETAPEARRIVEE)
    REFERENCES T_ETAPES(IDX_ETAPE)
    ON DELETE CASCADE
    ON UPDATE CASCADE;

ALTER TABLE T_VEHICULES
  ADD CONSTRAINT T_VEHICULES_FOREIGN_KEY01
  FOREIGN KEY (IDX_MARQUE)
    REFERENCES T_MARQUES(IDX_MARQUE)
    ON DELETE CASCADE
    ON UPDATE CASCADE;

ALTER TABLE T_VEHICULES
  ADD CONSTRAINT T_VEHICULES_FOREIGN_KEY02
  FOREIGN KEY (IDX_TYPEVEHICULE)
    REFERENCES T_TYPESVEHICULES(IDX_TYPEVEHICULE)
    ON DELETE CASCADE
    ON UPDATE CASCADE;

/* Données pour la table  */
INSERT INTO T_ANNEESSCOLAIRES (IDX_ANNEESCOLAIRE, ANNEEANNEESCOLAIRE) VALUES (1, 2022);
INSERT INTO T_ANNEESSCOLAIRES (IDX_ANNEESCOLAIRE, ANNEEANNEESCOLAIRE) VALUES (2, 2021);
INSERT INTO T_ANNEESSCOLAIRES (IDX_ANNEESCOLAIRE, ANNEEANNEESCOLAIRE) VALUES (3, 2024);
INSERT INTO T_ANNEESSCOLAIRES (IDX_ANNEESCOLAIRE, ANNEEANNEESCOLAIRE) VALUES (6, 2023);
INSERT INTO T_ANNEESSCOLAIRES (IDX_ANNEESCOLAIRE, ANNEEANNEESCOLAIRE) VALUES (7, 2025);
INSERT INTO T_ANNEESSCOLAIRES (IDX_ANNEESCOLAIRE, ANNEEANNEESCOLAIRE) VALUES (8, 2026);
INSERT INTO T_ANNEESSCOLAIRES (IDX_ANNEESCOLAIRE, ANNEEANNEESCOLAIRE) VALUES (9, 2027);
COMMIT;

/* Données pour la table  */
INSERT INTO T_CHAUFFEURS (IDX_CHAUFFEUR, PRENOMCHAUFFEUR, PRINCIPALCHAUFFEUR, ACTIFCHAUFFEUR) VALUES (1, 'Thierry', FALSE, TRUE);
INSERT INTO T_CHAUFFEURS (IDX_CHAUFFEUR, PRENOMCHAUFFEUR, PRINCIPALCHAUFFEUR, ACTIFCHAUFFEUR) VALUES (2, 'Karim', TRUE, TRUE);
INSERT INTO T_CHAUFFEURS (IDX_CHAUFFEUR, PRENOMCHAUFFEUR, PRINCIPALCHAUFFEUR, ACTIFCHAUFFEUR) VALUES (3, 'Miguel', TRUE, TRUE);
INSERT INTO T_CHAUFFEURS (IDX_CHAUFFEUR, PRENOMCHAUFFEUR, PRINCIPALCHAUFFEUR, ACTIFCHAUFFEUR) VALUES (4, 'Ali', FALSE, TRUE);
INSERT INTO T_CHAUFFEURS (IDX_CHAUFFEUR, PRENOMCHAUFFEUR, PRINCIPALCHAUFFEUR, ACTIFCHAUFFEUR) VALUES (6, 'Magalie', FALSE, FALSE);
COMMIT;

/* Données pour la table  */
INSERT INTO T_EPHEMERIDES (IDX_EPHEMERIDE, IDX_ANNEESCOLAIRE, NOMEPHEMERIDE, STARTDATEPHEMERIDE, ENDDATEPHEMERIDE) VALUES (9, 1, 'NoÃ«l', '2022-12-25', '2022-12-25');
INSERT INTO T_EPHEMERIDES (IDX_EPHEMERIDE, IDX_ANNEESCOLAIRE, NOMEPHEMERIDE, STARTDATEPHEMERIDE, ENDDATEPHEMERIDE) VALUES (10, 1, 'CFWB', '2022-09-27', '2022-09-27');
INSERT INTO T_EPHEMERIDES (IDX_EPHEMERIDE, IDX_ANNEESCOLAIRE, NOMEPHEMERIDE, STARTDATEPHEMERIDE, ENDDATEPHEMERIDE) VALUES (12, 6, 'CFWB', '2023-09-27', '2023-09-27');
INSERT INTO T_EPHEMERIDES (IDX_EPHEMERIDE, IDX_ANNEESCOLAIRE, NOMEPHEMERIDE, STARTDATEPHEMERIDE, ENDDATEPHEMERIDE) VALUES (13, 1, 'Vacances d''hiver', '2022-12-26', '2023-01-06');
COMMIT;

/* Données pour la table  */
INSERT INTO T_ETAPES (IDX_ETAPE, NOMETAPE, ADRESSEETAPE, PRINTEDETAPE, LATITUDEETAPE, LONGITUDEETAPE, ALTITUDEETAPE) VALUES (1, 'CERIA', 'Avenue Emile Gryson 1 1070 Anderlecht', FALSE, 50.81617, 4.295274, 24);
INSERT INTO T_ETAPES (IDX_ETAPE, NOMETAPE, ADRESSEETAPE, PRINTEDETAPE, LATITUDEETAPE, LONGITUDEETAPE, ALTITUDEETAPE) VALUES (2, 'Redouté', 'Avenue Marius Renard 1, 1070 Anderlecht', FALSE, 50.827663, 4.289884, 34);
INSERT INTO T_ETAPES (IDX_ETAPE, NOMETAPE, ADRESSEETAPE, PRINTEDETAPE, LATITUDEETAPE, LONGITUDEETAPE, ALTITUDEETAPE) VALUES (9, 'Test', 'Test', TRUE, 1, 1, 1);
INSERT INTO T_ETAPES (IDX_ETAPE, NOMETAPE, ADRESSEETAPE, PRINTEDETAPE, LATITUDEETAPE, LONGITUDEETAPE, ALTITUDEETAPE) VALUES (10, 'Bon Air', 'Rue du pommier 101, 1070 Anderlecht', FALSE, 50.833784, 4.275431, 53);
COMMIT;

/* Données pour la table  */
INSERT INTO T_GROUPES (IDX_GROUPE, NOMGROUPE, NOMBREACCOMPAGNATEURGROUPE, NOMBREGROUPE) VALUES (1, 'ABC', 1, 35);
INSERT INTO T_GROUPES (IDX_GROUPE, NOMGROUPE, NOMBREACCOMPAGNATEURGROUPE, NOMBREGROUPE) VALUES (2, 'CBA', 2, 45);
COMMIT;

/* Données pour la table  */

/* Données pour la table  */
INSERT INTO T_INDISPONIBILITESCHAUFFEURS (IDX_INDISPONIBILITECHAUFFEUR, IDX_CHAUFFEUR, STARTDATEINDISPONIBILITE, STARTTIMEINDISPONIBILITE, ENDDATEINDISPONIBILITE, ENDTIMEINDISPONIBILITE, ALLDAYINDISPONIBILITE) VALUES (8, 4, '2022-12-05', '00:00:00', '2022-12-05', '23:59:00', TRUE);
INSERT INTO T_INDISPONIBILITESCHAUFFEURS (IDX_INDISPONIBILITECHAUFFEUR, IDX_CHAUFFEUR, STARTDATEINDISPONIBILITE, STARTTIMEINDISPONIBILITE, ENDDATEINDISPONIBILITE, ENDTIMEINDISPONIBILITE, ALLDAYINDISPONIBILITE) VALUES (10, 4, '2022-12-09', '00:00:00', '2022-12-09', '23:59:00', TRUE);
INSERT INTO T_INDISPONIBILITESCHAUFFEURS (IDX_INDISPONIBILITECHAUFFEUR, IDX_CHAUFFEUR, STARTDATEINDISPONIBILITE, STARTTIMEINDISPONIBILITE, ENDDATEINDISPONIBILITE, ENDTIMEINDISPONIBILITE, ALLDAYINDISPONIBILITE) VALUES (11, 4, '2022-12-08', '00:00:00', '2022-12-08', '23:59:00', TRUE);
COMMIT;

/* Données pour la table  */
INSERT INTO T_INDISPONIBILITESVEHICULES (IDX_INDISPONIBILITEVEHICULE, IDX_VEHICULE, STARTDATEINDISPONIBILITE, STARTTIMEINDISPONIBILITE, ENDDATEINDISPONIBILITE, ENDTIMEINDISPONIBILITE, ALLDAYINDISPONIBILITE) VALUES (2, 9, '2023-01-30', '00:10:00', '2023-01-31', '23:00:00', FALSE);
INSERT INTO T_INDISPONIBILITESVEHICULES (IDX_INDISPONIBILITEVEHICULE, IDX_VEHICULE, STARTDATEINDISPONIBILITE, STARTTIMEINDISPONIBILITE, ENDDATEINDISPONIBILITE, ENDTIMEINDISPONIBILITE, ALLDAYINDISPONIBILITE) VALUES (3, 9, '2023-02-03', '00:00:00', '2023-02-03', '23:59:59', TRUE);
COMMIT;

/* Données pour la table  */
INSERT INTO T_MARQUES (IDX_MARQUE, NOMMARQUE) VALUES (1, 'Mercedes');
INSERT INTO T_MARQUES (IDX_MARQUE, NOMMARQUE) VALUES (2, 'Otokar');
INSERT INTO T_MARQUES (IDX_MARQUE, NOMMARQUE) VALUES (3, 'CitroÃ«n');
INSERT INTO T_MARQUES (IDX_MARQUE, NOMMARQUE) VALUES (4, 'Peugeot');
COMMIT;

/* Données pour la table  */
INSERT INTO T_ORGANISATIONS (IDX_ORGANISATION, IDX_GROUPE, DATEORGANISATION, TIMEORGANISATION) VALUES (2, 1, '2023-09-01', '10:00:00');
INSERT INTO T_ORGANISATIONS (IDX_ORGANISATION, IDX_GROUPE, DATEORGANISATION, TIMEORGANISATION) VALUES (3, 2, '2023-09-01', '10:00:00');
COMMIT;

/* Données pour la table  */
INSERT INTO T_TRAJETS (IDX_TRAJET, IDX_ETAPEDEPART, IDX_ETAPEARRIVEE, NOMTRAJET, TEMPSTRAJET, KMTRAJET) VALUES (1, 1, 2, 'CERIA-Redouté', '10:00:00', 10);
INSERT INTO T_TRAJETS (IDX_TRAJET, IDX_ETAPEDEPART, IDX_ETAPEARRIVEE, NOMTRAJET, TEMPSTRAJET, KMTRAJET) VALUES (2, 2, 1, 'Redouté-CERIA', '00:11:00', 10.5);
INSERT INTO T_TRAJETS (IDX_TRAJET, IDX_ETAPEDEPART, IDX_ETAPEARRIVEE, NOMTRAJET, TEMPSTRAJET, KMTRAJET) VALUES (4, 2, 10, 'Redouté-Bon Air', '00:06:00', 5);
COMMIT;

/* Données pour la table  */
INSERT INTO T_TYPESVEHICULES (IDX_TYPEVEHICULE, NOMTYPEVEHICULE) VALUES (2, 'Camion');
INSERT INTO T_TYPESVEHICULES (IDX_TYPEVEHICULE, NOMTYPEVEHICULE) VALUES (3, 'Autocar');
INSERT INTO T_TYPESVEHICULES (IDX_TYPEVEHICULE, NOMTYPEVEHICULE) VALUES (4, 'Camionette');
COMMIT;

/* Données pour la table  */
INSERT INTO T_VEHICULES (IDX_VEHICULE, IDX_MARQUE, IDX_TYPEVEHICULE, NOMVEHICULE, PLACESVEHICULE, NUMEROVEHICULE, PLAQUEVEHICULE, MODELEVEHICULE) VALUES (7, 2, 3, 'Otokar', 37, 1, '1', '1');
INSERT INTO T_VEHICULES (IDX_VEHICULE, IDX_MARQUE, IDX_TYPEVEHICULE, NOMVEHICULE, PLACESVEHICULE, NUMEROVEHICULE, PLAQUEVEHICULE, MODELEVEHICULE) VALUES (8, 1, 3, 'GEO', 60, 320, '1-XXX-123', 'XxXxXxXxX');
INSERT INTO T_VEHICULES (IDX_VEHICULE, IDX_MARQUE, IDX_TYPEVEHICULE, NOMVEHICULE, PLACESVEHICULE, NUMEROVEHICULE, PLAQUEVEHICULE, MODELEVEHICULE) VALUES (9, 1, 3, 'GEO2', 40, 202, '1-XXX-123', '40 places');
COMMIT;

